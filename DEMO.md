# Демонстрационный сценарий (DEMO.md)

Этот сценарий предназначен для проверяющих жюри, чтобы оценить "Продуктовую ценность", "Качество работы" и стабильность `DevBoost MCP Server`.

## Подготовка стенда

Всего одной командой мы поднимем:
1. Тестовую БД PostgreSQL с таблицей `users` на 100 000 записей (без индексов по email).
2. Наш MCP-сервер `devboost`, подключенный к этой БД.

Выполните в корне проекта:
```bash
docker-compose up -d --build
```
Дождитесь статуса `healthy` у контейнера `db`.

## Тестирование через MCP Inspector (для Жюри Хакатона)

Если у вас нет установленного Claude Desktop или Cursor, можно протестировать работу сервера в браузере через официальную утилиту Inspector:

В новом терминале:
```bash
# 1. Активируем виртуальное окружение
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt && pip install -e .

# 2. Выдаем права на исполнение нашему скрипту входа
chmod +x run_stdio.py

# 3. Задаем URL до нашей поднятой в докере базы
export DATABASE_URL=postgresql://testuser:testpass@localhost:5432/testdb

# 4. Запускаем Inspector (Осторожно, потребуется npx/Node.js)
npx -y @modelcontextprotocol/inspector ./run_stdio.py
```

После запуска:
1. Откроется браузер (обычно `http://localhost:6274`).
2. Нажмите кнопку **Connect**.
3. Перейдите во вкладку **Chat** и начните диалог с симуляцией ИИ, общающимся с нашим сервером.

## Прохождение сценария с AI

Откройте веб-интерфейс Inspector и попросите агента (через чат) выполнить следующие 3 задания. Вы увидите, как он использует наши Tools.

### Сценарий 1: Устранение неполадок окружения
**Промпт агенту:** 
> "Проверь, установлены ли у меня python и docker с помощью check_versions. Затем представь, что порт 5432 завис (хотя БД запущена специально) - вызови kill_port_hog для порта 8080 (просто для проверки)."

**Ожидаемый результат:** Агент вызовет `check_versions` и покажет актуальные версии. Затем вызовет `kill_port_hog`, который вернет информационное сообщение (т.к. мы в безопасности проверяем только порты текущего юзера).

### Сценарий 2: Поиск узкого места в БД (Боль 1)
**Промпт агенту:**
> "У меня тормозит поиск пользователей по email в БД. Используй инструмент explain_query для запроса: SELECT * FROM users WHERE email = 'target@mcp.test'. Скажи, какое время выполнения и есть ли Seq Scan?"

**Ожидаемый результат:** Агент выполнит `EXPLAIN ANALYZE` и вернет JSON-план. Он увидит "Seq Scan" (т.к. индекса нет, а строк 100к) и время около 10-30ms.

### Сценарий 3: Оптимизация (Боль 2)
**Промпт агенту:**
> "Теперь вызови suggest_index для таблицы ['users'] чтобы узнать текущие индексы. Увидев отсутствие индекса по email, сгенерируй для меня SQL-команду CREATE INDEX, чтобы исправить Seq Scan из предыдущего шага."

**Ожидаемый результат:** Инструмент покажет, что на таблице `users` нет индексов кроме первичного ключа. AI-агент, основываясь на этом, выдаст готовый код: `CREATE INDEX idx_users_email ON users(email);`.

## Остановка стенда
```bash
docker-compose down -v
```
